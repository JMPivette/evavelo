---
title: "ae-full_xlsx_export"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ae-full_xlsx_export}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(evavelo)
library(openxlsx)
library(magrittr)
```

The aim of this vignette is to apply process_evavelo to a file and to export the full modified file:

### Import file

```{r import file}
xlsx_path <- system.file("example-data/02_simplified.xlsx", package = "evavelo")
wb <- openxlsx::loadWorkbook(xlsx_path)
```

### Process file

```{r process file}
out_evavelo <- process_evavelo(xlsx_path)
```

### Modify object

Modification has to be done directly to the wb object using writeData() function under the hood.

```{r}
update_wb(wb, out_evavelo)
```


### Save to xlsx

```{r}
#out_filename <- here::here("inst", "example-data", "02_simplified_out.xlsx" )
#openxlsx::saveWorkbook(wb, out_filename, overwrite = TRUE)

```

Save seems to work correctly but there are some glitches:
* Blank cells are loosing their background colors..
* font size changed from 11 to 10
* some font changed from white to black
* Some Blank cells have been transformed to NA (https://github.com/ycphs/openxlsx/issues/72)

I will not try to fix all the bugs right now.

