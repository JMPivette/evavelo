---
title: "ba-using_package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ba-using_package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, include = FALSE}
library(evavelo)
library(magrittr)
library(dplyr)
```

## Import and clean file
Importation et nettoyage des données.

```{r import files}
# Full data
#xlsx_path <- system.file("example-data/01_all.xlsx", package = "evavelo")
# Corrected data
#xlsx_path <- here::here("inst", "example-data", "01a_all_correct.xlsx")
# Reduced size data
xlsx_path <- system.file("example-data/02_simplified.xlsx", package = "evavelo")
#xlsx_path <- here::here("inst", "example-data", "02_simplified.xlsx")


## Sheet: Comptage Post Traitements-------------
comptage <- evavelo::read_comptage(xlsx_path)

## Sheet: Enquetes Post Traitements-----------
enquete <- evavelo::read_enquete(xlsx_path)

## Sheet: Calendrier-----------
calendrier <- evavelo::read_calendrier(xlsx_path)


```

### Test input values

```{r test}
check <- evavelo::check_evavelo(calendrier,comptage, enquete)
message(check)

```
Il y a des doublons dans le id_quest au niveau des comptages manuels (https://github.com/JMPivette/evavelo/issues/13). 
Il faudra probablement régler le problème dans la vérification du fichier xlsx.

Certains id_quest des enquêtes n'apparaissent pas dans le comptages manuels. (https://github.com/JMPivette/evavelo/issues/14) 


## Correction categorie

Utilisation de la function `evavelo::correct_categ()` pour afficher les catégories corrigées.

```{r correct_categ}
evavelo::correct_categ(comptage, enquete)


```



